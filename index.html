<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MagicCards | Viral Greeting Generator</title>
    <style>
        :root {
            --primary: #ff4b6e;
            --primary-dark: #ff335c;
            --sidebar-bg: #f8f9fa;
            --text-dark: #333;
            --muted: #6c757d;
            --card-bg: #fff;
            --accent: #ffeef1;
        }
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            min-height: 100vh;
            background: #fff;
            color: var(--text-dark);
            overflow: hidden;
        }

        /* Sidebar & Search */
        #sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            border-right: 1px solid #eee;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .search-box { 
            width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; 
            margin-bottom: 20px; box-sizing: border-box; outline: none;
        }
        .search-box:focus { border-color: var(--primary); }
        
        #menu-container { flex: 1; overflow-y: auto; }
        .menu-item { 
            padding: 12px 15px; margin: 5px 0; color: var(--text-dark); 
            text-decoration: none; border-radius: 8px; cursor: pointer; font-weight: 500; 
        }
        .menu-item:hover, .menu-item.active { background: #ffeef1; color: var(--primary); }

        /* Main Content */
        #main-content {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
            background: #fff;
        }
        .hero {
            background: linear-gradient(135deg, #ff4b6e, #ff8e8e);
            color: white;
            padding: 32px;
            border-radius: 24px;
            margin-bottom: 24px;
            display: grid;
            gap: 16px;
        }
        .hero h1 { margin: 0; font-size: clamp(1.8rem, 3vw, 2.6rem); }
        .hero p { margin: 0; max-width: 520px; }
        .hero-actions { display: flex; flex-wrap: wrap; gap: 12px; }
        .hero-btn {
            border: none;
            background: white;
            color: var(--primary);
            font-weight: 700;
            padding: 12px 18px;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .hero-btn.primary {
            background: #ffffff;
            color: var(--primary);
        }
        .hero-btn.secondary {
            background: rgba(255, 255, 255, 0.15);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.35);
        }
        .hero-btn:hover { transform: translateY(-2px); box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15); }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        .card-thumbnail { border: 1px solid #eee; border-radius: 18px; overflow: hidden; transition: 0.3s; cursor: pointer; background: var(--card-bg); position: relative; }
        .card-thumbnail:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        .thumbnail-img { height: 140px; background: #fff0f3; display: flex; justify-content: center; align-items: center; font-size: 3rem; }
        .card-details { padding: 15px; display: grid; gap: 6px; }
        .card-details h3 { margin: 0; font-size: 1rem; color: #333; }
        .card-meta { font-size: 0.8rem; color: var(--muted); }
        
        .badge { position: absolute; top: 10px; right: 10px; background: var(--primary); color: white; padding: 3px 8px; border-radius: 5px; font-size: 0.6rem; font-weight: bold; }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }
        .stat-card {
            background: var(--accent);
            padding: 16px;
            border-radius: 16px;
        }
        .stat-card h3 { margin: 0 0 6px; }
        .stat-card span { color: var(--muted); font-size: 0.85rem; }

        .how-it-works {
            background: #fdf2f4;
            border-radius: 18px;
            padding: 22px;
            margin: 24px 0;
            display: grid;
            gap: 12px;
        }
        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }
        .step {
            background: white;
            border-radius: 14px;
            padding: 14px;
            border: 1px solid #ffe0e6;
        }
        .step span { font-weight: 700; color: var(--primary); }

        .community-banner {
            margin-top: 24px;
            background: #fff8f9;
            border-radius: 18px;
            padding: 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }
        .community-banner button {
            border: none;
            background: var(--primary);
            color: white;
            padding: 10px 16px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
        }

        @media (max-width: 900px) {
            body { flex-direction: column; overflow: auto; }
            #sidebar { width: 100%; border-right: none; border-bottom: 1px solid #eee; }
            #main-content { padding: 24px; }
        }
    </style>
</head>
<body>

    <nav id="sidebar">
        <h2 style="color:var(--primary);">MagicCards ‚ù§Ô∏è</h2>
        <span style="color: var(--muted); font-size: 0.85rem;">Make it fun. Make it viral.</span>
        <input type="text" class="search-box" id="searchInput" placeholder="Search cards..." onkeyup="handleSearch()">
        
        <div id="menu-container"></div>
    </nav>

    <main id="main-content">
        <div class="hero">
            <h1>Make Someone Smile Today! üöÄ</h1>
            <p>Select a prank or a greeting, add their name, and send the link. The more you share, the more surprises you unlock.</p>
            <div class="hero-actions">
                <button class="hero-btn primary" onclick="scrollToGallery()">Browse Trending Cards</button>
                <button class="hero-btn secondary" onclick="surpriseMe()">üé≤ Surprise me</button>
            </div>
        </div>

        <section class="stats">
            <div class="stat-card">
                <h3>12k+</h3>
                <span>Magic links shared this week</span>
            </div>
            <div class="stat-card">
                <h3>4.9‚òÖ</h3>
                <span>Average smile rating</span>
            </div>
            <div class="stat-card">
                <h3>3 sec</h3>
                <span>Average time to create</span>
            </div>
        </section>

        <section class="how-it-works">
            <h2 style="margin:0;">The Viral Loop üîÅ</h2>
            <div class="steps">
                <div class="step"><span>1.</span> Pick a card that matches their vibe.</div>
                <div class="step"><span>2.</span> Add their name & get a magic link.</div>
                <div class="step"><span>3.</span> Share on WhatsApp, Instagram, or anywhere.</div>
                <div class="step"><span>4.</span> They open it and create their own.</div>
            </div>
        </section>

        <div id="cardGrid" class="grid">
            </div>

        <section class="community-banner">
            <div>
                <strong>üî• New: Creator Leaderboard</strong>
                <p style="margin:6px 0 0; color: var(--muted); font-size: 0.9rem;">Share 3 links to unlock a surprise badge.</p>
            </div>
            <button onclick="scrollToGallery()">Start Sharing</button>
        </section>
    </main>

    <script>
        const sheetUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://docs.google.com/spreadsheets/d/e/2PACX-1vQ7Xp2IV6Zt4aMorOp9ivwlDIoO5bQFiFrIS4PCzEiBUeXmgK1WQj7egnZqB3skS7kUYJBE0040OAHh/pub?gid=0&single=true&output=csv');
        
        const localCardsData = [
            { title: 'Impossible No', category: 'Valentine', emoji: 'üåπ', fileName: 'valentine/impossibleno.html' },
            { title: 'Birthday Blast', category: 'Birthday', emoji: 'üéÇ', fileName: 'birthday/blast.html' },
            { title: 'Friendship Meter', category: 'Friendship', emoji: 'ü§ù', fileName: 'friendship/forever.html' },
            { title: 'Sorry Bear', category: 'Apology', emoji: 'üß∏', fileName: 'apology/bear.html' },
            { title: 'Spin the Prank', category: 'Prank', emoji: 'üé°', fileName: 'prank/spin.html' },
            { title: 'Launch Your Dream', category: 'Motivation', emoji: 'üöÄ', fileName: 'motivation/rocket.html' },
            { title: 'Anniversary Timeline', category: 'Anniversary', emoji: 'üíû', fileName: 'anniversary/timeline.html' },
            { title: 'Gratitude Jar', category: 'Gratitude', emoji: 'üôè', fileName: 'gratitude/thanks.html' },
            { title: 'Friendly Roast', category: 'Roast', emoji: 'üî•', fileName: 'roast/mildroast.html' },
            { title: 'Lucky Charm', category: 'Good Luck', emoji: 'üçÄ', fileName: 'goodluck/lucky.html' },
            { title: 'Secret Confession', category: 'Confession', emoji: 'üíå', fileName: 'confession/secret.html' },
            { title: 'Pun Generator', category: 'Jokes', emoji: 'üòÇ', fileName: 'jokes/pun.html' },
            { title: 'Fireworks Night', category: 'Celebration', emoji: 'üéÜ', fileName: 'celebration/fireworks.html' },
            { title: 'Heartbeat Crush', category: 'Crush', emoji: 'üíì', fileName: 'crush/heartbeat.html' },
            { title: 'Focus Sprint', category: 'Study', emoji: 'üìö', fileName: 'study/focus.html' },
            { title: 'Travel Postcard', category: 'Travel', emoji: 'üß≥', fileName: 'travel/postcard.html' },
            { title: 'Level Up', category: 'Gaming', emoji: 'üéÆ', fileName: 'gaming/levelup.html' },
            { title: 'Goal Cheer', category: 'Sports', emoji: '‚öΩ', fileName: 'sports/goal.html' },
            { title: 'Snack Picker', category: 'Food', emoji: 'üçø', fileName: 'food/snack.html' },
            { title: 'Diwali Lights', category: 'Festival', emoji: 'ü™î', fileName: 'festival/diwali.html' },
            { title: 'Spooky Surprise', category: 'Halloween', emoji: 'üéÉ', fileName: 'halloween/spooky.html' },
            { title: 'New Year Countdown', category: 'New Year', emoji: 'üéä', fileName: 'newyear/countdown.html' },
            { title: 'Graduation Cap Toss', category: 'Graduation', emoji: 'üéì', fileName: 'graduation/gradcap.html' },
            { title: 'Warm Welcome', category: 'Welcome', emoji: 'üëã', fileName: 'welcome/hello.html' },
            { title: 'Miss You Echo', category: 'Miss You', emoji: 'üíå', fileName: 'missyou/echo.html' },
            { title: 'Big Congrats', category: 'Congrats', emoji: 'üèÜ', fileName: 'congrats/trophy.html' },
            { title: 'Pep Talk', category: 'Encouragement', emoji: 'üåü', fileName: 'encouragement/pep.html' },
            { title: 'Paw Promise', category: 'Pets', emoji: 'üêæ', fileName: 'pet/paw.html' },
            { title: 'Playlist Mood', category: 'Music', emoji: 'üéµ', fileName: 'music/playlist.html' },
            { title: 'Movie Night', category: 'Movie', emoji: 'üé¨', fileName: 'movie/ticket.html' },
            { title: 'Break Reminder', category: 'Work', emoji: '‚òï', fileName: 'work/break.html' }
        ];

        let allCardsData = [];

        async function init() {
            try {
                const response = await fetch(sheetUrl);
                const csvText = await response.text();
                const rows = csvText.split('\n').slice(1);
                
                const sheetCards = rows.map(row => {
                    const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                    return {
                        title: cols[0]?.replace(/"/g, '').trim(),
                        category: cols[1]?.replace(/"/g, '').trim(),
                        emoji: cols[2]?.replace(/"/g, '').trim(),
                        fileName: cols[3]?.replace(/"/g, '').trim()
                    };
                }).filter(c => c.title);

                const uniqueByFile = new Map();
                [...sheetCards, ...localCardsData].forEach(card => {
                    if (card.fileName) {
                        uniqueByFile.set(card.fileName, card);
                    }
                });
                allCardsData = Array.from(uniqueByFile.values());
                if (!allCardsData.length) {
                    allCardsData = localCardsData;
                }
            } catch (e) {
                console.error(e);
                allCardsData = localCardsData;
            }

            buildDynamicMenu();
        }

        function buildDynamicMenu() {
            const container = document.getElementById('menu-container');
            container.innerHTML = '';
            const cats = [...new Set(allCardsData.map(c => c.category))];
            cats.forEach(cat => {
                if(!cat) return;
                const div = document.createElement('div');
                div.className = 'menu-item';
                div.innerText = cat.charAt(0).toUpperCase() + cat.slice(1);
                div.onclick = () => filterCards(cat, div);
                container.appendChild(div);
            });
            if (cats.length) {
                container.firstChild.classList.add('active');
                const firstCategory = cats[0];
                const filtered = allCardsData.filter(c => c.category === firstCategory);
                renderCards(filtered);
            }
        }

        function renderCards(cards) {
            const grid = document.getElementById('cardGrid');
            grid.innerHTML = cards.length ? '' : '<p>No cards found matching your search.</p>';
            cards.forEach(card => {
                if (!card.fileName) return;
                const item = document.createElement('div');
                item.className = 'card-thumbnail';
                item.onclick = () => window.location.href = `create.html?file=${card.fileName}`;
                item.innerHTML = `
                    <div class="badge">TRENDING</div>
                    <div class="thumbnail-img">${card.emoji}</div>
                    <div class="card-details">
                        <h3>${card.title}</h3>
                        <span class="card-meta">${card.category} ¬∑ Ready in 3 sec</span>
                    </div>
                `;
                grid.appendChild(item);
            });
        }

        function scrollToGallery() {
            document.getElementById('cardGrid').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function surpriseMe() {
            if (!allCardsData.length) return;
            const randomCard = allCardsData[Math.floor(Math.random() * allCardsData.length)];
            window.location.href = `create.html?file=${randomCard.fileName}`;
        }

        function handleSearch() {
            const term = document.getElementById('searchInput').value.toLowerCase();
            const filtered = allCardsData.filter(c => c.title.toLowerCase().includes(term));
            renderCards(filtered);
        }

        function filterCards(cat, el) {
            document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
            const filtered = allCardsData.filter(c => c.category === cat);
            renderCards(filtered);
        }

        init();
    </script>
</body>
</html>
